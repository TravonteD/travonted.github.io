<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>Effective Git</title>
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
  </style>
  <link rel="stylesheet" href="../style.css" />
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<section class="article">
<header id="title-block-header">
<nav>
  <a href="../index.html"><li>Travonte D.</li></a>
  <a href="../index.html"><li>home</li></a>
  <a href="../articles.html"><li>articles</li></a>
  <a href="https://github.com/travonted"><li>github</li></a>
</nav>
<h1 class="title">Effective Git</h1>
</header>
<p>Git is a version control tool intended to allow decentralized management of code (namely the Linux Kernel). It however has found its way throughout many code bases and for good reason. Its many features make it easy and simple to keep track of changes in code and any other plain-text document. Most people have only a limited knowledge of git and its capabilities, so I’m going to go through some of the lesser known commands that make managing the repository easy</p>
<h3 id="git-stash">Git stash</h3>
<p>Do you ever have that bit of code that you’re working on, but then realize that you’re not in the correct branch? Then, when you attempt to checkout the proper message you’re met with an error that looks like this.</p>
<p><code>error: Your local changes to the following files would be overwritten by checkout:</code></p>
<p>So what do you do? Some people will rename the file temporarily, checkout the branch then rename it back so that they can commit. Others will open the file in an editor so that they can simple save the changes again after they remove the file and checkout the proper branch. The git centric solution to this problem is “git stash”. From the manual:</p>
<blockquote>
<p>“Use git stash when you want to record the current state of the working directory and the index, but want to go back to a clean working directory. The command saves your local modifications away and reverts the working directory to match the HEAD commit.”</p>
</blockquote>
<p>This is exactly what we were looking for! So now we can run the command</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode zsh"><code class="sourceCode zsh"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true"></a><span class="kw">&gt;</span> git stash save</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true"></a>Saved working directory and index state WIP on dark_mode: 4304fd7 remove status bar</span></code></pre></div>
<p>to see the list run <strong>git stash list</strong></p>
<div class="sourceCode" id="cb2"><pre class="sourceCode zsh"><code class="sourceCode zsh"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true"></a><span class="kw">&gt;</span> git stash list</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true"></a>stash@<span class="dt">{0}</span>: WIP on dark_mode: 4304fd7 remove status bar</span></code></pre></div>
<p>and after checking out the correct branch run <strong>git stash pop</strong></p>
<div class="sourceCode" id="cb3"><pre class="sourceCode zsh"><code class="sourceCode zsh"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true"></a><span class="kw">&gt;</span> git stash pop</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true"></a>On branch dark_mode</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true"></a>Your branch is up to <span class="kw">date</span> with <span class="st">&#39;origin/dark_mode&#39;</span>.</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true"></a></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true"></a>Changes not staged <span class="kw">for</span> commit:</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true"></a>  <span class="kw">(</span>use <span class="st">&quot;git add &lt;file&gt;...&quot;</span> to update what will be committed<span class="kw">)</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true"></a>  <span class="kw">(</span>use <span class="st">&quot;git checkout -- &lt;file&gt;...&quot;</span> to discard changes <span class="kw">in</span> working directory<span class="kw">)</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true"></a></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true"></a>        modified:   .tmux.conf</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true"></a>        modified:   config/newsboat/config</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true"></a>        modified:   init.vim</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true"></a>        modified:   scripts/ddg.rb</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true"></a></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true"></a>no changes added to commit <span class="kw">(</span>use <span class="st">&quot;git add&quot;</span> and/or <span class="st">&quot;git commit -a&quot;</span><span class="kw">)</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true"></a>Dropped refs/stash@<span class="dt">{0}</span> <span class="kw">(</span>3337c0c25b6055febcfe0a9141b9ea70a90dc68f<span class="kw">)</span></span></code></pre></div>
<p>and there are my changes ready to be committed!</p>
<h2 id="git-log">Git log</h2>
<p>Most people who use git know what git log is. It’s the list of commits that have been made in the repository. It has a ton of features that I rarely see get used so I’m going to highlight a few of them.</p>
<h3 id="git-log---follow"><code>git log --follow</code></h3>
<p>This command allows you to <strong>look through the history of a single file even <em>beyond</em> its renames</strong>. Which is great for when you change “thing.rb” to “thing_v1.rb”. Many people don’t realize that the commits are still tied you just need to specify that you want them. The only caveat with this command is that it can only be used on a single file at a time. So you’ll need to know where to look.</p>
<h3 id="git-log---grepinvert-grepall-match"><code>git log --grep/invert-grep/all-match</code></h3>
<p>These are a quick way to find that commit that you made weeks ago relating to a certain piece of code. If you’ve named your commits well, you can give an expression and <strong>grep &amp; invert-grep will give the first match, and all-match will give any commits that match the search expression</strong></p>
<h3 id="git-log---sinceuntildate"><code>git log --since/until=&lt;date&gt;</code></h3>
<p>If you know that you’ve made a change, say last week, that you want to find. You can use the <strong>since</strong> and <strong>until</strong> flags to <strong>time constrain the dates</strong> to be from Monday to Friday of last week. <strong>You can also filter using a range if you have the commit refs like so <code>git log 61966bf..</code></strong></p>
<h2 id="git-revert">Git revert</h2>
<p>This command is often avoided for fear of losing information, but I believe that it is a false notion about what this command does. <strong>Git revert simply takes a change that you made in your commit and makes a new commit with the opposite thing done.</strong> For instance, you’ve deleted some code that seemed unimportant and now have realized that it is in fact necessary for the feature. Instead of going through the log and copy-pasting from the diff, or rewriting it you can use git revert.</p>
<p>Lets say I have this commit that I want to revert:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode zsh"><code class="sourceCode zsh"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true"></a>commit edee54c add ruby shebang</span></code></pre></div>
<p>When I run the command <code>git revert edee54(this is a shortname)</code>, <strong>git creates a new commit with a helpful commit message with a reference to the previous commit</strong> like so:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode zsh"><code class="sourceCode zsh"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true"></a>Revert <span class="st">&quot;add ruby shebang&quot;</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true"></a>This reverts commit edee54c11c2a7f7a9f20d0ce91dd69fee0a562e8.</span></code></pre></div>
<p>Now I just finalize the commit and I’ve picked up the change that I needed easy-peasy!</p>
<h2 id="git-add---patch">Git add --patch</h2>
<p>We’ve all gotten on a roll and added a ton of changes to a file in between commits. Then we think to ourselves “what am I going to say in the message?” There are so many changes, some unrelated to each other that it would be a paragraph to write and it would make our git log less useful because the small change we may need to find is bundled into this gigantic commit. Enter <code>git add --patch</code>. <strong>This command brings up an interactive menu with the changes to each file that shows us each “hunk” that has been changed.</strong></p>
<div class="sourceCode" id="cb6"><pre class="sourceCode diff"><code class="sourceCode diff"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true"></a><span class="dt">@@ -24,7 +32,12 @@ module CoreMIDI</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true"></a>   functions.each do |func|</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true"></a><span class="st">-    attach_function *func</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true"></a><span class="va">+    begin</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true"></a><span class="va">+      attach_function *func</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true"></a><span class="va">+    rescue Exception =&gt; e</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true"></a><span class="va">+      $stderr.puts &quot;Couldn&#39;t attach function #{func.first}&quot;</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true"></a><span class="va">+      raise</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true"></a><span class="va">+    end</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true"></a>   end</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true"></a></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true"></a>   def midi_read_proc()</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true"></a>Stage this hunk [y/n/a/d/K/j/J/e/?]?</span></code></pre></div>
<p>Here entering “?” will describe each of the options at the bottom. Here’s a quick guide to get you going:</p>
<ul>
<li>“y” - Yes, add this hunk</li>
<li>“n” - No, don’t add this hunk</li>
<li>“a” - add this hunk and the remaining hunks. (Useful when you want to add the rest of the changes)</li>
<li>“d” - No, don’t add this hunk and the remaining hunks. (Useful for when you’re done adding and want to skip to the end)</li>
<li>“s” - Split the hunk into smaller hunks (this only works if there are unchanged lines between the pieces)</li>
<li>“e” - Manually edit the hunk (will open up a text editor for you to add exactly what you want, but I usually just use ‘s’)</li>
</ul>
<p>Now we can just commit the changes that we want grouped together, or commit each change individually with its own descriptive commit message! If the hunks are still to large you can even break them up into smaller pieces. This makes for a better git log so that we can find the changes that we need easily and precisely.</p>
</section>
</body>
</html>
